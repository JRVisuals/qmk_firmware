
#define JRV_IDLE_FRAMES 4

#define JRV_ANIM_FRAME_DURATION 150 // how long each frame lasts in ms
// #define SLEEP_TIMER 60000 // should sleep after this period of 0 wpm, needs fixing
#define JRV_ANIM_SIZE 636 // number of bytes in array, minimize for adequate firmware size, max is 1024

uint32_t jrv_anim_timer         = 0;
uint32_t jrv_anim_sleep         = 30;
uint8_t  jrv_current_idle_frame = 0;

static void render_zninit1_anim(void) {
    static const char PROGMEM idle[JRV_IDLE_FRAMES][JRV_ANIM_SIZE] = {{
0x00, 0x00, 0xe0, 0x10, 0x08, 0x08, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x08, 0x08, 0x10, 0xe0, 0x00, 0x00,
0x00, 0x00, 0xff, 0x00, 0x00, 0xff, 0x00, 0xf5, 0x14, 0xf5, 0x00, 0x41, 0x40, 0x41, 0x00, 0xe9,
0x28, 0xe9, 0x00, 0x7d, 0x44, 0x45, 0x44, 0x7d, 0x00, 0x54, 0xff, 0x00, 0x00, 0xff, 0x00, 0x00,
0x00, 0x00, 0xff, 0x00, 0x00, 0xff, 0x00, 0xff, 0xe0, 0xff, 0x00, 0xff, 0x81, 0xff, 0x00, 0xff,
0x80, 0xff, 0x00, 0xff, 0xe1, 0xe1, 0xe1, 0xff, 0x00, 0x55, 0xff, 0x00, 0x00, 0xff, 0x00, 0x00,
0x00, 0x00, 0x0f, 0x10, 0x20, 0x21, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22,
0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x21, 0x20, 0x10, 0x0f, 0x00, 0x00,},
                                                              {
0x00, 0x00, 0xe0, 0x10, 0x08, 0x08, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x08, 0x08, 0x10, 0xe0, 0x00, 0x00,
0x00, 0x00, 0xff, 0x00, 0x00, 0xff, 0x00, 0xf5, 0x14, 0xf5, 0x00, 0x41, 0x40, 0x41, 0x00, 0xe9,
0x28, 0xe9, 0x00, 0x7d, 0x44, 0x45, 0x44, 0x7d, 0x00, 0x54, 0xff, 0x00, 0x00, 0xff, 0x00, 0x00,
0x00, 0x00, 0xff, 0x00, 0x00, 0xff, 0x00, 0xff, 0xff, 0xff, 0x00, 0xff, 0xe1, 0xff, 0x00, 0xff,
0xc0, 0xff, 0x00, 0xff, 0xf9, 0xf9, 0xf9, 0xff, 0x00, 0x55, 0xff, 0x00, 0x00, 0xff, 0x00, 0x00,
0x00, 0x00, 0x0f, 0x10, 0x20, 0x21, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22,
0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x21, 0x20, 0x10, 0x0f, 0x00, 0x00},
                                                              {
0x00, 0x00, 0xe0, 0x10, 0x08, 0x08, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x08, 0x08, 0x10, 0xe0, 0x00, 0x00,
0x00, 0x00, 0xff, 0x00, 0x00, 0xff, 0x00, 0xf5, 0x14, 0xf5, 0x00, 0x41, 0x40, 0x41, 0x00, 0xe9,
0x28, 0xe9, 0x00, 0x7d, 0x64, 0x65, 0x64, 0x7d, 0x00, 0x54, 0xff, 0x00, 0x00, 0xff, 0x00, 0x00,
0x00, 0x00, 0xff, 0x00, 0x00, 0xff, 0x00, 0xff, 0xfc, 0xff, 0x00, 0xff, 0xf9, 0xff, 0x00, 0xff,
0xe0, 0xff, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x55, 0xff, 0x00, 0x00, 0xff, 0x00, 0x00,
0x00, 0x00, 0x0f, 0x10, 0x20, 0x21, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22,
0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x21, 0x20, 0x10, 0x0f, 0x00, 0x00,},
                                                              {
0x00, 0x00, 0xe0, 0x10, 0x08, 0x08, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x08, 0x08, 0x10, 0xe0, 0x00, 0x00,
0x00, 0x00, 0xff, 0x00, 0x00, 0xff, 0x00, 0xf5, 0x14, 0xf5, 0x00, 0x41, 0x40, 0x41, 0x00, 0xe9,
0x28, 0xe9, 0x00, 0x7d, 0x7c, 0x7d, 0x7c, 0x7d, 0x00, 0x54, 0xff, 0x00, 0x00, 0xff, 0x00, 0x00,
0x00, 0x00, 0xff, 0x00, 0x00, 0xff, 0x00, 0xff, 0xc0, 0xff, 0x00, 0xff, 0xe1, 0xff, 0x00, 0xff,
0xff, 0xff, 0x00, 0xff, 0x8f, 0x8f, 0x8f, 0xff, 0x00, 0x55, 0xff, 0x00, 0x00, 0xff, 0x00, 0x00,
0x00, 0x00, 0x0f, 0x10, 0x20, 0x21, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22,
0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x21, 0x20, 0x10, 0x0f, 0x00, 0x00,},
                                                             };



    // assumes 1 frame prep stage
    void animation_phase(void) {

            jrv_current_idle_frame = jrv_current_idle_frame + 1;
            if(jrv_current_idle_frame>JRV_IDLE_FRAMES-1){
                jrv_current_idle_frame = 0;
            }
            oled_write_P(idle[abs(jrv_current_idle_frame)], JRV_ANIM_SIZE);

    }

        if (timer_elapsed32(jrv_anim_sleep) > OLED_TIMEOUT) {
            oled_off();
        } else {
            if (timer_elapsed32(jrv_anim_timer) > JRV_ANIM_FRAME_DURATION) {
                jrv_anim_timer = timer_read32();
                animation_phase();
            }
        }

}
